import datetime

bucket_name = 'stogaring-tiki-data'
current_time = datetime.datetime.now().strftime("%d%m%y")
file_dir = f'/opt/airflow/data_crawl/data_product_{current_time}.csv'

output_file = f'data_product_{current_time}.csv'### output file name when to crawl data
output_dir = '/opt/airflow/data_crawl'### output file path when to crawl data

create_sales_fact_table = "CREATE TABLE IF NOT EXISTS sales_fact_table \
(id SERIAL PRIMARY KEY, \
product_id INT NOT NULL, \
date_id INT NOT NULL, \
price_after_voucher DECIMAL(10,2), \
original_price DECIMAL(10,2), \
discount_rate DECIMAL(10,2), \
discount_price DECIMAL(10,2), \
quantity_sold INT, \
rating_average DECIMAL(10,2), \
review_count INT, \
FOREIGN KEY (product_id) REFERENCES product_dim_table (product_id) \
FOREIGN KEY (date_id) REFERENCES date_dim_table (date_id) \
);"

create_product_dim_table = "CREATE TABLE IF NOT EXISTS product_dim_table( \
product_id INT PRIMARY KEY, \
product_name VARCHAR(255), \
brand_name VARCHAR(255), \
short_description TEXT, \
warranty_info VARCHAR(255), \
return_policy VARCHAR(255), \
url_img TEXT);"

create_date_dim_table = "CREATE TABLE IF NOT EXISTS date_dim_table \
(date_id SERIAL PRIMARY KEY, \
date DATE NOT NULL, \
day INT, \
month INT, \
year INT, \
quarter INT );"




product_list = [
125182567,
217706932,
271362153,
217645692,
274550926,
276109904,
274171148,
270975124,
273252926,
184059211,
273951550,
276110023,
271973414,
273258825,
276110349,
274101255,
270977740,
271046571,
205815576,
276110276,
271972435,
275913708,
275585819,
274101262,
214756058,
274037360,
273942001,
276158277,
275510578,
276044893,
274037365,
275583801,
274681250,
270471101,
275349801,
274721226,
275716541,
275237083,
184036446,
270471106,
275432684,
276285659,
204237269,
201067649,
275913711,
276250848,
276067924,
275307093,
274681248,
274948704,
276102293,
274959691,
276290869,
276161888,
276158234,
275571989,
271966786,
273610368,
276166741,
276091995,
274069052,
274536294,
274959118,
275915202,
275588494,
274946446,
271967379,
275618841,
276032854,
197214029,
274405521,
276043797,
209927605,
200819471,
274019962,
274544634,
276250878,
274638430,
275206906,
275492145,
252586291,
274560616,
276290046,
247427990,
242434782,
164213695,
4048043,
181927774,
275496965,
275510579,
246163082,
276285657,
275386982,
181928208,
275386649,
275152276,
271234577,
274524050,
273411988,
275589387,
173789184,
275042829,
273718967,
271218081,
273440662,
163914808,
118100164,
275572013,
275583780,
276099688,
274721231,
140184098,
271530789,
273412211,
274869053,
252428990,
275589968,
226552005,
181927736,
276104423,
274059475,
276045770,
276045754,
275583785,
273990229,
139632023,
276045562,
275042833,
273258830,
275778981,
274904904,
275629952,
274610468,
275761381,
273664463,
270495179,
275773755,
273454566,
273232944,
272222033,
276119719,
270707514,
276132850,
275295006,
276079498,
276246838,
270512785,
181452535,
217505430,
275774747,
270814316,
272394241,
273373420,
270504848,
11251951,
4048581,
275621450,
276123744,
11251743,
271798615,
275571990,
274415640,
275583783,
275543388,
274857095,
207883258,
273559020,
273029857,
273684137,
270260682,
274839897,
273872197,
275966307,
276281988,
276061374,
273498357,
271128271,
274617822,
261965186,
273610105,
275966298,
275295008,
274625697,
260406257,
274638556,
274191773,
196197701,
275773434,
270791102,
275543373,
276039435,
274868116,
208171115,
262908601,
274958815,
275543365,
209872337,
271234313,
192694043,
274840120,
217548686,
274840632,
176909016,
274866839,
191350420,
276375414,
276079491,
272234493,
274868043,
275407523,
263798932,
275621214,
272392928,
275773333,
273373436,
274908645,
147969070,
276074109,
72310420,
173387789,
274619667,
270794184,
274958868,
275504632,
162866839,
274364026,
179547641,
273636845,
272241346,
254125720,
272328188,
276062770,
273186334,
203853390,
276410628,
275775866,
275773774,
276307101,
249890023,
273366296,
262516014,
170165701,
249168949,
272113804,
275773463,
275386374,
276025189,
274257669,
275774606,
272273680,
248005118,
215746882,
11802138,
275773905,
249955152,
276306086,
270814388,
274099409,
275543355,
271954384,
274625942,
274610380,
273683300,
160450655,
275775981,
274375122,
276094665,
274456447,
217276360,
188030974,
272850971,
271730109,
274065746,
276079463,
274030201,
273958512,
270814412,
219400421,
140940220,
276411458,
263675862,
275776790,
273359059,
273438724,
250113073,
276079472,
274839974,
274840089,
140747649,
275916954,
91281318,
118486668,
274393574,
43924153,
275335546,
248762051,
275774243,
25949745,
274625981,
251407092,
262706645,
272348047,
275775805,
275774235,
273653444,
276246826,
217505504,
274378214,
276119902,
274541336,
271801317,
276046675,
23142193,
274392442,
273185467,
276323340,
247730209,
275746497,
275774759,
276032851,
276083329,
273430216,
273438458,
274840015,
275775850,
275773439,
248929458,
274516951,
206218031,
275774445,
275044287,
276079477,
275773881,
271329051,
275773400,
251448280,
276257720,
275773550,
249169833,
276079479,
276181205,
178311123,
276032852,
276094658,
275108186,
53380152,
275775811,
275774447,
273227290,
276369646,
276079503,
252884859,
275775340,
271467653,
275775887,
72310352,
11376644,
272056193,
275775836,
249178196,
29440849,
204671569,
275774892,
275773888,
140144656,
258787119,
275695395,
276181269,
275773451,
276209758,
276146399,
275775799,
125171841,
275773562,
275577204,
249143473,
275627388,
191764688,
275773410,
276125096,
272270730,
157835051,
276274790,
275774745,
181927718,
248754839,
276079496,
11415485,
272238679,
181928189,
219392186,
275774241,
113475741,
273407277,
118100268,
275774628,
271799133,
11251711,
275775883,
273595363,
]